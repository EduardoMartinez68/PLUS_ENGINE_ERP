<style>
  .photo-patient {
    width: 100%;          /* ocupa todo el ancho disponible */
    aspect-ratio: 1 / 1;  /* fuerza un cuadrado */
    object-fit: cover;    /* recorta para que no se deforme */
  }

.report-header {
  margin-bottom: 20px;
  background-color: transparent;
}

.hospital-logo {
  width: 80px;
  height: 80px;
  object-fit: contain;
  margin-right: 20px;
}

.hospital-info {
  flex: 1;
}

.hospital-name {
  margin: 0;
  font-size: 24px;
  font-weight: bold;
  color: #2c3e50;
}

.hospital-sub {
  margin: 0;
  font-size: 16px;
  color: #555;
}

.divider {
  border-top: 2px solid var(primary);
  margin: 20px 0;
}

.section-title{
  background-color: var(--primary);
  color: white;
  font-size: 1.3rem;
  padding: 10px 15px;
  display: inline-block;
}

.information-date {
  display: flex;           /* activa flexbox */
  justify-content: flex-end; /* empuja todo al final (derecha) */
  align-items: center;      /* centra verticalmente si hay más de un elemento */
  gap: 10px;  
}
</style>
<div class="container-section">

<header class="report-header d-flex align-items-center">
  <img src="https://www.gob.mx/cms/uploads/press/main_image/156266/post_logo.jpg" 
        alt="Logo Hospital" class="hospital-logo">
  <div class="hospital-info">
    <h1 class="hospital-name">Hospital General de la Salud</h1>
    <p class="hospital-sub">Reporte Médico del Paciente</p>
  </div>
</header>

<div class="row section g-4">
  <input-field label="Identificador (Skull)" id="skull" name="skull" required></input-field>
</div>

<div class="row section">
  <div class="col-3">
    <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?fm=jpg&q=60&w=3000&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8bXVqZXIlMjBmZWxpenxlbnwwfHwwfHx8MA%3D%3D" alt="" class="photo-patient">
  </div>
  <div class="col-8" style="padding: 10px 15px;">
    <plus-title label="Nombre del paciente" placeholder="title-type-customer" required id="title-customer-edit" value="Julieta Martinez Lopez"></plus-title>

    <div class="col">

      <!--here exist the information of the teeth-->
      <div class="teeth-chart" id="teethChart"></div>



      <div class="information-date">
        <label for="">Última visita 30/09/2025</label><br>
      </div>
    </div>
  </div>
</div>

<p class="section-title">Información</p>
<div class="row section">
    <div class="col">
      <input-field label="Altura (cm)" type="number" id="height_cm" name="height_cm" step="0.01"></input-field>
    </div>
    <div class="col">
      <input-field label="Peso (kg)" type="number" id="weight_kg" name="weight_kg" step="0.01"></input-field>
    </div>
    <div class="col">
      <input-field label="IMC" type="number" id="bmi" name="bmi" readonly></input-field>
    </div>
</div>

<div class="row section">
  <div class="col">
    <plus-select label="Tipo de sangre" name="blood_type" id="blood_type"  required>
      <option value="A+">A+</option>
      <option value="A-">A-</option>
      <option value="B+">B+</option>
      <option value="B-">B-</option>
      <option value="AB+">AB+</option>
      <option value="AB-">AB-</option>
      <option value="O+">O+</option>
      <option value="O-">O-</option>
    </plus-select>
  </div>
  <div class="col">
    <label></label>
    <label for="">Última visita</label>
    <plus-date name="last_visit" label="Última visita"></plus-date>
  </div>
</div>
</div>

<div class="container py-4">


  <form method="POST">
    {% csrf_token %}
    <!-- Campos de texto grandes -->
    <div class="mb-3">
      <label class="form-label">Condiciones crónicas</label>
      <textarea class="form-control" name="chronic_conditions" rows="2"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Alergias</label>
      <textarea class="form-control" name="allergies" rows="2"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Medicamentos</label>
      <textarea class="form-control" name="medications" rows="2"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Cirugías</label>
      <textarea class="form-control" name="surgeries" rows="2"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Vacunas</label>
      <textarea class="form-control" name="immunizations" rows="2"></textarea>
    </div>

    <div class="row section">
      <label class="form-label">Historial familiar</label>
      <textarea class="form-control" name="family_history" rows="2"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Estilo de vida</label>
      <textarea class="form-control" name="lifestyle" rows="2"></textarea>
    </div>

    <!-- Contacto de emergencia -->
    <h4 class="mt-4">Contacto de Emergencia</h4>

    <div class="mb-3">
      <label class="form-label">Nombre</label>
      <input type="text" class="form-control" name="emergency_contact_name">
    </div>

    <div class="mb-3">
      <label class="form-label">Teléfono</label>
      <input type="text" class="form-control" name="emergency_contact_phone">
    </div>

    <div class="mb-3">
      <label class="form-label">Relación</label>
      <input type="text" class="form-control" name="emergency_contact_relation">
    </div>



    <!-- Notas -->
    <div class="mb-3">
      <label class="form-label">Notas</label>
      <textarea class="form-control" name="notes" rows="3"></textarea>
    </div>

    <!-- Info de otros doctores -->
    <div class="mb-3">
      <label class="form-label">Información de otros doctores</label>
      <textarea class="form-control" name="info_other_doctor" rows="3"></textarea>
    </div>

    <button type="submit" class="btn btn-primary">Guardar</button>
  </form>
</div>

<style>
  .teeth-chart {
    display: grid;
    grid-template-columns: repeat(16, 1fr);
    gap: 12px;
    margin-bottom: 30px;
    justify-items: center;
  }
  .tooth {
    cursor: pointer;
    width: 45px;
    height: 65px;
    transition: fill 0.2s ease;
  }
  .tooth path {
    fill: #ffffff;
    stroke: #B0B7C3;
    stroke-width: 2px;
    transition: fill 0.2s ease;
  }
  .tooth:hover path {
    fill: #E2E6EB;
  }
  .label {
    font-size: 0.7rem;
    text-align: center;
    margin-top: 4px;
    color: #2C3E50;
  }

  /* Estados */
  .state-caries path { fill: #ff6b6b; }      /* rojo */
  .state-obturacion path { fill: #f1c40f; }  /* amarillo */
  .state-endodoncia path { fill: #3498db; }  /* azul */
  .state-corona path { fill: #bdc3c7; }      /* gris metálico */
  .state-implante path { fill: #95a5a6; }    /* gris oscuro */
  .state-fractura path { fill: #ffffff; stroke: #e67e22; stroke-width: 3px; }
  .state-ausente path { fill: none; stroke: #B0B7C3; stroke-dasharray: 4; }
</style>

<div class="container">
  <div class="teeth-chart" id="teethChart"></div>
</div>

<script>
(() => {
  const teethChart = document.getElementById("teethChart");

  // Ejemplo de datos en JSON
  const teethData = {
    1: "caries",
    2: "corona",
    3: "extraccion",
    4: "implante",
    5: "fractura",
    6: "obturacion",
    7: "endodoncia",
    8: "ausente"
    // ... puedes seguir llenando los demás
  };

  function createTooth(number, state) {
    const wrapper = document.createElement("div");
    wrapper.style.display = "flex";
    wrapper.style.flexDirection = "column";
    wrapper.style.alignItems = "center";

    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("class", `tooth ${state ? "state-" + state : ""}`);
    svg.setAttribute("viewBox", "0 0 100 120");

    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute(
      "d",
      "M50 10 C30 10, 20 30, 20 50 C20 75, 35 95, 42 115 Q50 125, 58 115 C65 95, 80 75, 80 50 C80 30, 70 10, 50 10Z"
    );
    svg.appendChild(path);

    // Estado especial: fractura -> dibujar línea de fractura
    if (state === "fractura") {
      const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
      line.setAttribute("x1", "30");
      line.setAttribute("y1", "30");
      line.setAttribute("x2", "70");
      line.setAttribute("y2", "90");
      line.setAttribute("stroke", "#e67e22");
      line.setAttribute("stroke-width", "4");
      svg.appendChild(line);
    }

    // Estado especial: extracción -> dibujar X encima
    if (state === "extraccion") {
      const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
      line1.setAttribute("x1", "30");
      line1.setAttribute("y1", "30");
      line1.setAttribute("x2", "70");
      line1.setAttribute("y2", "90");
      line1.setAttribute("stroke", "#c0392b");
      line1.setAttribute("stroke-width", "4");
      svg.appendChild(line1);

      const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
      line2.setAttribute("x1", "70");
      line2.setAttribute("y1", "30");
      line2.setAttribute("x2", "30");
      line2.setAttribute("y2", "90");
      line2.setAttribute("stroke", "#c0392b");
      line2.setAttribute("stroke-width", "4");
      svg.appendChild(line2);
    }

    const label = document.createElement("div");
    label.classList.add("label");
    label.textContent = number;

    wrapper.appendChild(svg);
    wrapper.appendChild(label);

    return wrapper;
  }

  // Crear 32 dientes
  for (let i = 1; i <= 32; i++) {
    const state = teethData[i] || null;
    teethChart.appendChild(createTooth(i, state));
  }
})();
</script>


<plus-actions>
    <plus-action text="new-event" onclick="open_type_pop" combo="Shift+n"></plus-action>
    <plus-action text="title-create-type-event" onclick="open_pop_new_type_event" combo="Shift+e"></plus-action>
</plus-actions>

<message-pop title="title-pop-create-event" name="pop-data-event">
    <div class="container-pop">
        <plus-tabs>
            <plus-tab text="Description">
                <div class="section">
                    <label t="label-input-title">Title of the event</label>
                    <input type="text" name="name" class="case-title-input" placeholder="Title"
                        t-placeholder="placeholder-input-title" required maxlength="300" />
                </div>


                <div class="section">
                    <div class="row m-1">
                        <plus-select label="priority" name="priority" required>
                            <option selected t="priority.low"></option>
                            <option t="priority.normal"></option>
                            <option t="priority.high"></option>
                        </plus-select>

                        <plus-select label="label-search-home" name="tipo_documento" requerid
                            link="customers/search_customers_select/" add="open_pop_new_type_event"
                            edit_data="edit_data" delete_data="customers/search_customers_select/">

                        </plus-select>
                    </div>
                </div>

                <div class="section">
                    <plus-switch text="all-day" name="allDay" onclick="activate_event_all_the_day"></plus-switch>

                    <div class="row section">
                        <plus-date label="starts" name="start_date" id="start_date"></plus-date>
                        <plus-time label="starts" name="start_time" id="start_time"></plus-time>
                    </div>

                    <div class="row section">
                        <plus-date label="ends" name="end_date" id="end_date"></plus-date>
                        <plus-time label="ends" name="end_time" id="end_time"></plus-time>
                    </div>

                </div>

                <div class="section">
                    <plus-select label="Tiempo de aviso" name="alert_time" required>
                        <option selected t="alert.none"></option>
                        <option t="alert.5min"></option>
                        <option t="alert.10min"></option>
                        <option t="alert.15min"></option>
                        <option t="alert.30min"></option>
                        <option t="alert.1hr"></option>
                        <option t="alert.2hr"></option>
                        <option t="alert.1day"></option>
                        <option t="alert.2day"></option>
                        <option t="alert.1week"></option>
                    </plus-select>
                </div>

                <div class="section">
                    <info-label label="Email de invitados" message="Agrega correos y presiona Enter, coma o espacio"></info-label>
                    <plus-emails id="invitados" name="correos_invitados" label="Email de invitados"></plus-emails>
                </div>

                <div class="section">
                    <label for="description" t="label-description">Description</label>
                    <textarea name="description" id="description" rows="4" t-placeholder="placeholder-description"></textarea>
                </div>


            </plus-tab>


            <plus-tab text="More options">
                <div class="section">
                    <input-field label="label-input-address" name="location"
                        placeholder="placeholder-input-address"></input-field>
                </div>

                <div class="section">
                    <input-field label="label-link" type="text" name="link" placeholder="www/..."></input-field>
                </div>


                <plus-switch text="repeat_this_event" name="repeat_event" id="repeat_this_event" onclick="hidden_input_repet"></plus-switch>

                <div class="section" id="input_repet" style="display: none;">
                    <div class="row m-1">
                        <plus-select label="repeat" name="repeat" requerid>
                            <option selected t="option.never"></option>
                            <option t="option.every_day"></option>
                            <option t="option.every_week"></option>
                            <option t="option.every_2_weeks"></option>
                            <option t="option.every_month"></option>
                            <option t="option.every_year"></option>
                        </plus-select>


                        <plus-select label="endRepeat" name="endRepeat" requerid>
                            <option selected t="option.never">Never</option>
                            <option t="option.on_day">On Day</option>
                        </plus-select>
                    </div>
                </div>

                <plus-switch text="send_notification" name="send_notification" checked="true"></plus-switch>

                <plus-switch text="i_am_free" name="i_am_free" checked="true"></plus-switch>
            </plus-tab>
        </plus-tabs>
    </div>

    <button class="btn btn-add btn-success" t="message.success">Save</button>
</message-pop>




<message-pop title="title-create-type-event" name="pop-new-data-event">
    <div class="section">
        <label t="new-type-event">Title of the event</label>
        <input type="text" name="name" class="case-title-input" t-placeholder="new-type-event" required
            maxlength="300" />
    </div>

    <div class="section">
        <label for="">Color</label>
        <input-color></input-color>
    </div>

    <button t="message.create" class="btn btn-success btn-add" onclick="create_new_type_event()">Success</button>
</message-pop>

<button onclick="show_pop('pop-new-data-event')">Open Type Pop</button>

<script>
    function open_type_pop() {
        //first we will to clear all the input of the form 
        update_pop_information()
        show_pop('pop-data-event')
      
    }


    function clean_form_event() {

    }










    function open_pop_new_type_event() {
        show_pop('pop-new-data-event')
    }

    function create_new_type_event() {
        //const title = document.querySelector('input[name="name"]').value;
        //const color = document.querySelector('input[name="color"]').value;

        // Here you would typically send this data to your server
        //console.log('Creating new type event:', { title, color });
        hide_pop('pop-new-data-event')
    }

</script>

<script>
    /*
  function initEmailInput() {
    // Variables globales accesibles desde window
    window.container = document.getElementById('email-tags-container');
    window.input = document.getElementById('email-input');
    window.jsonOutput = document.getElementById('emails-json');
    window.emails = [];

    window.focusEmailInput = function () {
      window.input.focus();
    }

    window.addEmail = function (email) {
      email = email.trim();
      if (email && window.validateEmail(email) && !window.emails.includes(email)) {
        window.emails.push(email);

        const tag = document.createElement('span');
        tag.className = 'email-tag';
        tag.innerHTML = `${email} <button onclick="window.removeEmail('${email}')">&times;</button>`;
        window.container.insertBefore(tag, window.input);
        window.input.value = '';
        window.updateJson();
      }
    }

    window.removeEmail = function (email) {
      const index = window.emails.indexOf(email);
      if (index > -1) {
        window.emails.splice(index, 1);
        [...window.container.getElementsByClassName('email-tag')].forEach(tag => {
          if (tag.textContent.includes(email)) {
            window.container.removeChild(tag);
          }
        });
        window.updateJson();
      }
    }

    window.updateJson = function () {
      window.jsonOutput.textContent = JSON.stringify(window.emails, null, 2);
    }

    window.validateEmail = function (email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    window.input.addEventListener('keydown', function (e) {
      if (e.key === 'Enter' || e.key === ',' || e.key === ' ') {
        e.preventDefault();
        window.addEmail(window.input.value);
      }
    });
  }

  // Inicializa todo
  initEmailInput();
  */
</script>


<script>
  (() => {
    const mySwitch = document.getElementById('repeat_this_event');
    console.log(mySwitch)
    console.log(mySwitch.checked);  // true o false seg√∫n el estado
  });




  //------------------her is for update the information of the pop-----------------------//
  function update_pop_information() {
    //get the date 
    const day = new Date();


    //get the date update
    change_label_date('start_date', day);
    change_label_date('end_date', day);

    //her also update the information of the minutes for get the time 
    const hours = day.getHours().toString().padStart(2, '0');
    const minutes = day.getMinutes().toString().padStart(2, '0');
    const time = `${hours}:${minutes}`;
    change_label_time('start_time', time);
    change_label_time('end_time', time);
  }










  function hidden_input_repet(status) {
    const inputRepet = document.getElementById('input_repet');
    if (status) {
      inputRepet.style.display = 'block';
    } else {
      inputRepet.style.display = 'none';
    }
  }

  function activate_event_all_the_day(status) {
    //her also update the information of the minutes for get the time 
    change_label_time('start_time', '00:00');
    change_label_time('end_time', '23:59');
  }


  function format_date_to_text(date) {
  const day = String(date.getDate()).padStart(2, '0');
  const month = String(date.getMonth() + 1).padStart(2, '0'); // Los meses van de 0 a 11
  const year = date.getFullYear();
  return `${day}/${month}/${year}`;
}




  /*---------------------------CHANGE INFO OF LABELS---------------------------*/
  function change_label_date(id, newDate){
    const plusDate = document.getElementById(id);

    if (!plusDate) return;

    // her we will see if the component has a shadowRoot
    const shadow = plusDate.shadowRoot;
    if (!shadow) return;

    // now we can search in the shadow DOM
    const input = shadow.querySelector('input[type="date"]');

    const label = shadow.querySelector('label');
    const displayDiv = shadow.querySelector('#plus-date-display');

    // Ejemplo: cambiar valor del input
    if (input) {
      input.value = newDate; // cualquier fecha v√°lida en formato yyyy-mm-dd
      displayDiv.textContent = format_date_to_text(newDate); // actualizar la visualizaci√≥n
    }
  }


  function change_label_time(id, newTime){
    const plusTime = document.getElementById(id);    
    if (!plusTime) return;

    // her we will see if the component has a shadowRoot
    const shadow = plusTime.shadowRoot;
    if (!shadow) return;

    // now we can search in the shadow DOM
    const input = shadow.getElementById(id);

    const label = shadow.querySelector('label');
    const displayDiv = shadow.querySelector('.time-picker-display');

    //get the hour and the time

    // Ejemplo: cambiar valor del input
    if (input) {
      input.value = newTime; // cualquier fecha v√°lida en formato yyyy-mm-dd
      displayDiv.textContent = newTime; // actualizar la visualizaci√≥n
    }
  }


  //her we will get the information of the status of the switch
  function get_status_switch(id) {
    const mySwitch = document.getElementById(id);
    if (!mySwitch) return;

    // her we will see if the component has a shadowRoot
    const shadow = mySwitch.shadowRoot;
    if (!shadow) return;


    const input = shadow.getElementById(id);
    return input.checked ? input.checked : false;
  }
</script>
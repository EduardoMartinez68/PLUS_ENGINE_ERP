
<plus-actions>
    <plus-action text="new-event" onclick="open_type_pop" combo="Shift+n"></plus-action>
    <plus-action text="title-create-type-event" onclick="open_pop_new_type_event" combo="Shift+e"></plus-action>
    <plus-action text="title-show-all-the-type-event" onclick="open_pop_show_all_type_event"></plus-action>
</plus-actions>

<message-pop title="title-pop-create-event" name="pop-data-event">
    {% include 'partials_agenda/formCreateNewEvent.html' %}
</message-pop>


<message-pop title="title-create-type-event" name="pop-new-data-event">
  {% include 'partials_agenda/createNewTypeEvent.html' %}
</message-pop>

<message-pop title="type-events" name="pop-show-all-the-type-event">
  {% include 'partials_agenda/showAllTypeEvent.html' %}
</message-pop>

<script>
    function open_type_pop() {
        //first we will to clear all the input of the form 
        update_pop_information()
        show_pop('pop-data-event')
      
    }


    function clean_form_event() {
      update_pop_information();
    }










    function open_pop_new_type_event() {
        show_pop('pop-new-data-event')
    }

    function create_new_type_event() {
        //const title = document.querySelector('input[name="name"]').value;
        //const color = document.querySelector('input[name="color"]').value;

        // Here you would typically send this data to your server
        //console.log('Creating new type event:', { title, color });
        hide_pop('pop-new-data-event')
    }

    function open_pop_show_all_type_event(){
      show_pop('pop-show-all-the-type-event')
    }
</script>

<script>
    /*
  function initEmailInput() {
    // Variables globales accesibles desde window
    window.container = document.getElementById('email-tags-container');
    window.input = document.getElementById('email-input');
    window.jsonOutput = document.getElementById('emails-json');
    window.emails = [];

    window.focusEmailInput = function () {
      window.input.focus();
    }

    window.addEmail = function (email) {
      email = email.trim();
      if (email && window.validateEmail(email) && !window.emails.includes(email)) {
        window.emails.push(email);

        const tag = document.createElement('span');
        tag.className = 'email-tag';
        tag.innerHTML = `${email} <button onclick="window.removeEmail('${email}')">&times;</button>`;
        window.container.insertBefore(tag, window.input);
        window.input.value = '';
        window.updateJson();
      }
    }

    window.removeEmail = function (email) {
      const index = window.emails.indexOf(email);
      if (index > -1) {
        window.emails.splice(index, 1);
        [...window.container.getElementsByClassName('email-tag')].forEach(tag => {
          if (tag.textContent.includes(email)) {
            window.container.removeChild(tag);
          }
        });
        window.updateJson();
      }
    }

    window.updateJson = function () {
      window.jsonOutput.textContent = JSON.stringify(window.emails, null, 2);
    }

    window.validateEmail = function (email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    window.input.addEventListener('keydown', function (e) {
      if (e.key === 'Enter' || e.key === ',' || e.key === ' ') {
        e.preventDefault();
        window.addEmail(window.input.value);
      }
    });
  }

  // Inicializa todo
  initEmailInput();
  */
</script>


<script>

  //------------------her is for update the information of the pop-----------------------//
  function update_pop_information() {
    //get the date 
    const day = new Date();


    //get the date update
    change_plus_date('start_date', day);
    change_plus_date('end_date', day);

    //her also update the information of the minutes for get the time 
    const hours = day.getHours().toString().padStart(2, '0');
    const minutes = day.getMinutes().toString().padStart(2, '0');
    const time = `${hours}:${minutes}`;
    change_plus_time('start_time', time);
    change_plus_time('end_time', time);
  }

  function hidden_input_repet(status) {
    const inputRepet = document.getElementById('input_repet');
    if (status) {
      inputRepet.style.display = 'block';
    } else {
      inputRepet.style.display = 'none';
    }
  }

  function activate_event_all_the_day(status) {
    //her also update the information of the minutes for get the time 
    change_plus_time('start_time', '00:00');
    change_plus_time('end_time', '23:59');
  }

  /*---------------------------CHANGE INFO OF LABELS---------------------------*/
  function format_date_to_text(date) {
  const day = String(date.getDate()).padStart(2, '0');
  const month = String(date.getMonth() + 1).padStart(2, '0'); // Los meses van de 0 a 11
  const year = date.getFullYear();
  return `${day}/${month}/${year}`;
}


  function change_plus_date(id, newDate){
    const plusDate = document.getElementById(id);

    if (!plusDate) return;

    // her we will see if the component has a shadowRoot
    const shadow = plusDate.shadowRoot;
    if (!shadow) return;

    // now we can search in the shadow DOM
    const input = shadow.querySelector('input[type="date"]');

    const label = shadow.querySelector('label');
    const displayDiv = shadow.querySelector('#plus-date-display');

    // Ejemplo: cambiar valor del input
    if (input) {
      input.value = newDate; // cualquier fecha v치lida en formato yyyy-mm-dd
      displayDiv.textContent = format_date_to_text(newDate); // actualizar la visualizaci칩n
    }
  }

  function change_plus_time(id, newTime){
    const plusTime = document.getElementById(id);    
    if (!plusTime) return;

    // her we will see if the component has a shadowRoot
    const shadow = plusTime.shadowRoot;
    if (!shadow) return;

    // now we can search in the shadow DOM
    const input = shadow.getElementById(id);

    const label = shadow.querySelector('label');
    const displayDiv = shadow.querySelector('.time-picker-display');

    //get the hour and the time

    // Ejemplo: cambiar valor del input
    if (input) {
      input.value = newTime; // cualquier fecha v치lida en formato yyyy-mm-dd
      displayDiv.textContent = newTime; // actualizar la visualizaci칩n
    }
  }

  //her we will get the information of the status of the switch
  function get_status_plus_switch(id) {
    const mySwitch = document.getElementById(id);
    if (!mySwitch) return;

    // her we will see if the component has a shadowRoot
    const shadow = mySwitch.shadowRoot;
    if (!shadow) return;


    const input = shadow.getElementById(id);
    return input.checked ? input.checked : false;
  }



</script>